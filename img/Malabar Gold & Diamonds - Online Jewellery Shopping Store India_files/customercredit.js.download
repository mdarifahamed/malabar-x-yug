
function checkOutLoadCustomerCredit(b){if(!$("customercredit_container")){var a=getElement();a.insert({after:b.html})}}function getElement(){var a=$("checkout-payment-method-load");if(a.down("#checkout-payment-method-load")==undefined){return a}else{return a.down("#checkout-payment-method-load")}}function changeSendStatus(d,a,c){validate("customercredit_value_input");var b=$("customercredit_email_input").value;var f=$("customercredit_value_input").value;var e=$("customercredit_message_textarea").value;if(b!=""&&validateEmail(b)&&b!=a&&f!=""&&isNumeric(f)&&f>0&&checkValue(d,f)){$("customercredit_show_loading_p").show();$("customercredit_send_credit_button").hide();$("customercredit_cancel_button").hide();c+="sendemail?email="+b+"&value="+f+"&message="+e;new Ajax.Request(c,{method:"post",postBody:"",onComplete:function(g){if(g.responseText.isJSON()){var h=g.responseText.evalJSON();if(h.success==1){$("customercredit_show_loading_p").hide()}}}})}}function checkEmailExisted(a,c){$("advice-your-email").hide();$("customercredit_send_credit_button").type="button";var b=$("customercredit_email_input").value;validate("customercredit_email_input");if(validateEmail(b)){$("customercredit_show_alert").hide();$("customercredit_show_success").hide();if(a!=b){$("customercredit_show_loading").show();c+="checkemail/email/"+b;new Ajax.Request(c,{method:"post",postBody:"",onComplete:function(d){$("customercredit_show_loading").hide();if(d.responseText.isJSON()){var e=d.responseText.evalJSON();if(e.existed==1){$("customercredit_show_success").show()}else{$("customercredit_show_alert").show()}$("customercredit_send_credit_button").type="submit"}}})}else{$("advice-your-email").show();inValidate("customercredit_email_input")}}}function checkValue(a,b){if(b-a>0&&b!=null){$("advice-validate-max-number").show();inValidate("customercredit_value_input");return false}else{$("advice-validate-max-number").hide();return true}}function validateEmail(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}function isNumeric(a){var b=/^-{0,1}\d*\.{0,1}\d+$/;return(b.test(a))}function inValidate(a){$(a).setStyle({border:"1px dashed #eb340a",background:"#faebe7"})}function validate(a){$(a).setStyle({border:"1px solid #b6b6b6",background:"#fff"})}function setButton(a){if(a.checked){$("is_check_send_email").value="yes"}}function enableCheckbox(){if($("customercreditcheck").length){$("customercreditcheck").removeAttribute("disabled");}if($("checkout_cc_inputtext").length){$("checkout_cc_inputtext").removeAttribute("disabled");}if($("checkout_cc_button").length){$("checkout-cc-button").removeAttribute("disabled")}}function showEditText(a){$("checkout-cc-input").hide();$("checkout-cc-img").hide();$("checkout_cc_inputtext").show();$("checkout-cc-button").show()}function changeUseCustomercredit(b,a){if(b.checked){$("cc_checkout").show();$("checkout_cc_inputtext").value="0"}else{$("cc_checkout").hide();new Ajax.Request(a,{method:"post",parameters:{check_credit:"unchecked"},onComplete:"",})}}function validateCheckOutCC(a){$("checkout-cc-button").type="submit";$("advice-validate-number-checkout_cc_smaller").hide();validate("checkout_cc_inputtext");var b=$("checkout_cc_inputtext").value;if(isNumeric(b)&&b-0>=0&&b-a>=0){$("advice-validate-number-checkout_cc_smaller").show();inValidate("checkout_cc_inputtext");$("checkout-cc-button").type="button"}}function updateCustomerCredit(b,a){var c=$("checkout_cc_inputtext").value;if(isNumeric(c)&&c!=""&&(c-0>=0)&&(c-a<=0)){$("customercredit_cc_show_loading").show();$("customercredit_cc_success_img").hide();$("checkout-cc-button").hide();b+="credit_amount/"+c;new Ajax.Request(b,{method:"post",postBody:"",onComplete:function(d){if(d.responseText.isJSON()){var e=d.responseText.evalJSON();if(e.amount!=0){$("checkout_cc_inputtext").value=e.amount}$("checkout_cc_inputtext").setStyle({backgroundColor:"rgb(253, 246, 228)"});$("customercredit_cc_show_loading").hide();$("checkout-cc-button").show();$("customercredit_cc_success_img").show();c=e.amount}}})}};
